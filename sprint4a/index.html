---
layout: default

stylesheets:
- sprint4a.css

scripts:
- sprint4a/procurements-list.js

body_class: 'site__procurements-list'

title: Active Procurements
subtitle: Enforcement Program Office

columns:
  left: 1
  center: 8
  right: 3

sort_options:
- by: requested_award_date
  text: Award Date
- by: favorite
  text: Favorites
---

<form method="GET" class="js-autosubmit">
  <div class="input-with-btn">
    <div class="input-with-btn_input">
      <label for="sort-by">View by</label>
      <select id="sort-by" name="sort">
        <option value="">Default</option>
        {% for sort in page.sort_options %}
        <option value="{{ sort.by }}">{{ sort.text }}</option>
        {% endfor %}
      </select>
    </div>
    <div class="input-with-btn_btn">
      <button class="btn" type="button" action="export/">
        <span class="cf-icon cf-icon-download"></span>
        Export to Excel
      </button>
    </div>
  </div>
</form>

{% assign col = page.columns %}

{% for _pr in site.procurements %}
  {% assign pr = _pr | prepare_procurement %}
  {% assign id = _pr.id | split: '/' | last %}
<section class="procurement procurement-card"
  id="{{ id }}"
  data-json='{{ pr | jsonify | xml_escape }}'
  hidden>

  <div class="row card-header">
    <div class="col col-{{ col.left }}">
      <span class="procurement-due"
        {% if pr.due_in_days < 0 %}
        data-due="over"
        {% elsif pr.due_in_days < 30 %}
        data-due="soon"
        {% endif %}>
        {{ pr.due_in_days }} days
      </span>
    </div>
    <h1 class="col col-{{ col.center }}">
      <a href="{{ pr.url }}">{{ pr.name }}</a>
    </h1>
    <div class="col col-{{ col.right }}">
      <label is="cfpb-fave-star">
        <input type="checkbox" name="{{ id }}">
      </label>
    </div>
  </div>

  <div class="row">
    <div class="col col-{{ col.left }}"></div>
    <div class="col col-{{ col.center }}">
      <h5>Obligated amount</h5>
      ${{ pr.obligated_value | number_to_currency }}
    </div>
    <div class="col col-{{ col.right }}">
      <h5>Award date</h5>
      Requested: <time>{{ pr.requested_award_date }}</time>
      <br>Estimated: <time>{{ pr.estimated_award_date }}</time>
    </div>
  </div>

  <div class="row">
    <div class="col col-{{ col.left }}"></div>
    <div class="col col-{{ col.center | plus: col.right }}">
      <h5>Latest activity</h5>
      {% assign last_event = pr.events | last %}
      {% if last_event %}
      <p class="last-event">
        <a href="{{ last_event.url }}">{{ last_event.document }}</a>
        {{ last_event.action }}ed
        by {{ last_event.actor }}
        on {{ last_event.date }}
      </p>
      {% else %}
      <p class="no-data">There hasn't been any activity yet.</p>
      {% endif %}
    </div>
  </div>

</section>
{% endfor %}
